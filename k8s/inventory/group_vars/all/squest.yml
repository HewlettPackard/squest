# Kubernetes
k8s_kubeconfig_path: "/home/nico/Documents/tools4ocp-clusters/talos-test.k8s.glabs.hpecorp.net/kubeconfig"
k8s_cluster_fqdn: "talos-test.k8s.glabs.hpecorp.net"
#k8s_kubeconfig_path: "/path/to/kubeconfig"
#k8s_cluster_fqdn: k8s.domain.local
squest_namespace: "squest"
k8s_storage_class: "thin"


# DATABASE
squest_db:
  database: "squest_db"
  user: "squest_user"
  password: "squest_password"
  root_password: "p@ssw0rd"

# PHPMYADMIN
squest_phpmyadmin:
  enabled: true
  ingress:
    enabled: true
    host: "phpmyadmin.{{ k8s_cluster_fqdn }}"
    annotation:
      kubernetes.io/ingress.class: "nginx"
      ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
  env:
    TZ: Europe/Paris
    PMA_HOST: mariadb
    PMA_ARBITRARY: "1"
    MYSQL_USERNAME: root
    MYSQL_ROOT_PASSWORD: "{{ squest_db.root_password }}"

# RABBITMQ
squest_rabbitmq:
  user: rabbitmq
  password: rabbitmq

# Django
squest_django:
  image: "quay.io/hewlettpackardenterprise/squest:dev"
  ingress:
    enabled: true
    host: "squest.{{ k8s_cluster_fqdn }}"
    annotations:
      kubernetes.io/ingress.class: "nginx"
      ingress.kubernetes.io/ssl-redirect: "true"
      nginx.ingress.kubernetes.io/backend-protocol: "HTTP"
#  ldap:
#    ldap_config_file: "{{ lookup('file', playbook_dir + '/../Squest/ldap_config.py') }}"
  env:
    TZ: "Europe/Paris"
    DB_HOST: "mariadb"
    DB_PORT: "3306"
    REDIS_CACHE_HOST: "redis"
    DB_USER: "{{ squest_db.user }}"
    DB_PASSWORD: "{{ squest_db.password }}"
    WAIT_HOSTS: "mariadb:3306,rabbitmq:5672"
  backup:
    enabled: true
    crontab: "0 1 * * *"
  externalize_backup_via_rsync:
    enabled: true
    crontab: "30 1 * * *"
    private_ssh_key: "{{ lookup('file', '/home/nico/Desktop/id_ed25519_squest_k8s_dev') + '\n' }}"
    ssh_user: "squest_k8s_dev"
    ssh_server: "siam017.gre.hpecorp.net"
    remote_path: "/backup/squest_k8s_dev/"
