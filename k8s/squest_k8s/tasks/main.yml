- name: Create a dedicated namespace for Squest
  kubernetes.core.k8s:
    kubeconfig: "{{ k8s_kubeconfig_path }}"
    state: present
    definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: "{{ squest_namespace }}"

- name: Squest db
  ansible.builtin.include_tasks:
    file: 01-db.yml
    apply:
      tags: ["db"]
  tags: ["db"]

- name: Squest rabbitmq
  ansible.builtin.include_tasks:
    file: 02-rabbitmq.yml
    apply:
      tags: ["rabbitmq"]
  tags: ["rabbitmq"]

- name: Squest redis
  ansible.builtin.include_tasks:
    file: 03-redis.yml
    apply:
      tags: ["redis"]
  tags: ["redis"]

- name: Squest Django
  ansible.builtin.include_tasks:
    file: 04-django.yml
    apply:
      tags: ["django"]
  tags: ["django"]
